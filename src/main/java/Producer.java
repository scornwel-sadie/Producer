
import org.apache.kafka.clients.producer.KafkaProducer;
import org.apache.kafka.clients.producer.ProducerConfig;
import org.apache.kafka.clients.producer.ProducerRecord;

import java.util.Properties;
import java.util.Scanner;

public class Producer {
  //  private static Scanner in;

    public static void main(String[] argv)throws Exception {
        String TestData = "[1,\"9e640809-d0de-47fa-847f-7989a5375b73\",\"e6d29a75-cdaf-4dfa-b35d-90c77899eb10\",\"a9c89da4-1ec1-4a12-8415-eeff65951758\",1521560661830,1,0,{\"tenantId\":\"e6d29a75-cdaf-4dfa-b35d-90c77899eb10\",\"appInstId\":\"a9c89da4-1ec1-4a12-8415-eeff65951758\",\"appName\":\"Box\",\"action\":\"UPLOADED\",\"eventActor\":\"smithwc6@live.com\",\"resourceId\":\"283668764623\",\"resourceName\":\"notpassdata.txt\",\"resourceSize\":0,\"resourceType\":\"FILE\",\"resourceExtensionType\":\"txt\",\"resourceMimeType\":null,\"resourceOwnerName\":\"smitty.cornwell@oracle.com\",\"resourceOwnerId\":\"1939087316\",\"source\":{\"id\":\"fc520b5d-d8b3-4c2e-83fb-0c67f3da326e\",\"type\":\"webhook_event\",\"tenantId\":\"e6d29a75-cdaf-4dfa-b35d-90c77899eb10\",\"appInstId\":\"a9c89da4-1ec1-4a12-8415-eeff65951758\",\"rawEvent\":\"{\\\"type\\\":\\\"webhook_event\\\",\\\"id\\\":\\\"fc520b5d-d8b3-4c2e-83fb-0c67f3da326e\\\",\\\"created_at\\\":\\\"2018-03-19T10:03:36-07:00\\\",\\\"trigger\\\":\\\"FILE.UPLOADED\\\",\\\"webhook\\\":{\\\"id\\\":\\\"35613335\\\",\\\"type\\\":\\\"webhook\\\"},\\\"created_by\\\":{\\\"type\\\":\\\"user\\\",\\\"id\\\":\\\"1939107463\\\",\\\"name\\\":\\\"Smith Cornwell\\\",\\\"login\\\":\\\"smithwc6@live.com\\\"},\\\"source\\\":{\\\"id\\\":\\\"283668764623\\\",\\\"type\\\":\\\"file\\\",\\\"file_version\\\":{\\\"type\\\":\\\"file_version\\\",\\\"id\\\":\\\"298457585215\\\",\\\"sha1\\\":\\\"f60a3949ff8740a3bdba0b34da291b04a0147188\\\"},\\\"sequence_id\\\":\\\"0\\\",\\\"etag\\\":\\\"0\\\",\\\"sha1\\\":\\\"f60a3949ff8740a3bdba0b34da291b04a0147188\\\",\\\"name\\\":\\\"notpassdata.txt\\\",\\\"description\\\":\\\"\\\",\\\"size\\\":12734,\\\"path_collection\\\":{\\\"total_count\\\":2,\\\"entries\\\":[{\\\"type\\\":\\\"folder\\\",\\\"id\\\":\\\"0\\\",\\\"sequence_id\\\":null,\\\"etag\\\":null,\\\"name\\\":\\\"All Files\\\"},{\\\"type\\\":\\\"folder\\\",\\\"id\\\":\\\"47971923598\\\",\\\"sequence_id\\\":\\\"0\\\",\\\"etag\\\":\\\"0\\\",\\\"name\\\":\\\"hook2\\\"}]},\\\"created_at\\\":\\\"2018-03-19T10:03:36-07:00\\\",\\\"modified_at\\\":\\\"2018-03-19T10:03:36-07:00\\\",\\\"trashed_at\\\":null,\\\"purged_at\\\":null,\\\"content_created_at\\\":\\\"2018-01-12T12:18:45-08:00\\\",\\\"content_modified_at\\\":\\\"2018-01-12T12:18:45-08:00\\\",\\\"created_by\\\":{\\\"type\\\":\\\"user\\\",\\\"id\\\":\\\"1939107463\\\",\\\"name\\\":\\\"Smith Cornwell\\\",\\\"login\\\":\\\"smithwc6@live.com\\\"},\\\"modified_by\\\":{\\\"type\\\":\\\"user\\\",\\\"id\\\":\\\"1939107463\\\",\\\"name\\\":\\\"Smith Cornwell\\\",\\\"login\\\":\\\"smithwc6@live.com\\\"},\\\"owned_by\\\":{\\\"type\\\":\\\"user\\\",\\\"id\\\":\\\"1939087316\\\",\\\"name\\\":\\\"Smith Cornwell\\\",\\\"login\\\":\\\"smitty.cornwell@oracle.com\\\"},\\\"shared_link\\\":null,\\\"parent\\\":{\\\"type\\\":\\\"folder\\\",\\\"id\\\":\\\"47971923598\\\",\\\"sequence_id\\\":\\\"0\\\",\\\"etag\\\":\\\"0\\\",\\\"name\\\":\\\"hook2\\\"},\\\"item_status\\\":\\\"active\\\"},\\\"additional_info\\\":[]}\",\"trigger\":\"FILE.UPLOADED\",\"webhook\":{\"id\":\"35613335\",\"type\":\"webhook\"},\"source\":{\"id\":\"283668764623\",\"type\":\"file\",\"sha1\":\"f60a3949ff8740a3bdba0b34da291b04a0147188\",\"name\":\"notpassdata.txt\",\"size\":\"12734\",\"owned_by\":{\"id\":\"1939087316\",\"type\":\"user\",\"login\":\"smitty.cornwell@oracle.com\",\"name\":\"Smith Cornwell\"},\"parent\":{\"id\":\"47971923598\",\"type\":\"folder\",\"name\":\"hook2\",\"sequence_id\":\"0\",\"etag\":\"0\"},\"item\":null,\"extension\":\"txt\",\"file_version\":{\"id\":\"298457585215\",\"type\":\"file_version\",\"sha1\":\"f60a3949ff8740a3bdba0b34da291b04a0147188\"},\"path_collection\":{\"entries\":[{\"id\":\"0\",\"type\":\"folder\",\"name\":\"All Files\",\"sequence_id\":null,\"etag\":null},{\"id\":\"47971923598\",\"type\":\"folder\",\"name\":\"hook2\",\"sequence_id\":\"0\",\"etag\":\"0\"}],\"total_count\":\"2\"},\"created_at\":\"2018-03-19T10:03:36-07:00\",\"modified_at\":\"2018-03-19T10:03:36-07:00\",\"content_created_at\":\"2018-01-12T12:18:45-08:00\",\"content_modified_at\":\"2018-01-12T12:18:45-08:00\",\"created_by\":{\"id\":\"1939107463\",\"type\":\"user\",\"login\":\"smithwc6@live.com\",\"name\":\"Smith Cornwell\"},\"modified_by\":{\"id\":\"1939107463\",\"type\":\"user\",\"login\":\"smithwc6@live.com\",\"name\":\"Smith Cornwell\"},\"item_status\":\"active\",\"sequence_id\":\"0\",\"purged_at\":null,\"description\":\"\",\"shared_link\":null,\"etag\":\"0\",\"trashed_at\":null},\"created_at\":\"2018-03-19T10:03:36-07:00\",\"created_by\":{\"id\":\"1939107463\",\"type\":\"user\",\"login\":\"smithwc6@live.com\",\"name\":\"Smith Cornwell\"},\"additional_info\":[]},\"triggerType\":\"WEBHOOK\"}][1,\"46e18448-0739-4d0d-9d7f-cf94b24d81d6\",\"e6d29a75-cdaf-4dfa-b35d-90c77899eb10\",\"a9c89da4-1ec1-4a12-8415-eeff65951758\",1521560233267,1,0,{\"tenantId\":\"e6d29a75-cdaf-4dfa-b35d-90c77899eb10\",\"appInstId\":\"a9c89da4-1ec1-4a12-8415-eeff65951758\",\"appName\":\"Box\",\"action\":\"UPLOADED\",\"eventActor\":\"smithwc6@live.com\",\"resourceId\":\"283920683080\",\"resourceName\":\"notpassdata.txt\",\"resourceSize\":0,\"resourceType\":\"FILE\",\"resourceExtensionType\":\"txt\",\"resourceMimeType\":null,\"resourceOwnerName\":\"smitty.cornwell@oracle.com\",\"resourceOwnerId\":\"1939087316\",\"source\":{\"id\":\"9ca3f0d1-9dba-4afb-b45b-8cc81f7f8d8f\",\"type\":\"webhook_event\",\"tenantId\":\"e6d29a75-cdaf-4dfa-b35d-90c77899eb10\",\"appInstId\":\"a9c89da4-1ec1-4a12-8415-eeff65951758\",\"rawEvent\":\"{\\\"type\\\":\\\"webhook_event\\\",\\\"id\\\":\\\"9ca3f0d1-9dba-4afb-b45b-8cc81f7f8d8f\\\",\\\"created_at\\\":\\\"2018-03-20T08:22:41-07:00\\\",\\\"trigger\\\":\\\"FILE.UPLOADED\\\",\\\"webhook\\\":{\\\"id\\\":\\\"36213749\\\",\\\"type\\\":\\\"webhook\\\"},\\\"created_by\\\":{\\\"type\\\":\\\"user\\\",\\\"id\\\":\\\"1939107463\\\",\\\"name\\\":\\\"Smith Cornwell\\\",\\\"login\\\":\\\"smithwc6@live.com\\\"},\\\"source\\\":{\\\"id\\\":\\\"283920683080\\\",\\\"type\\\":\\\"file\\\",\\\"file_version\\\":{\\\"type\\\":\\\"file_version\\\",\\\"id\\\":\\\"298721521480\\\",\\\"sha1\\\":\\\"f60a3949ff8740a3bdba0b34da291b04a0147188\\\"},\\\"sequence_id\\\":\\\"0\\\",\\\"etag\\\":\\\"0\\\",\\\"sha1\\\":\\\"f60a3949ff8740a3bdba0b34da291b04a0147188\\\",\\\"name\\\":\\\"notpassdata.txt\\\",\\\"description\\\":\\\"\\\",\\\"size\\\":12734,\\\"path_collection\\\":{\\\"total_count\\\":2,\\\"entries\\\":[{\\\"type\\\":\\\"folder\\\",\\\"id\\\":\\\"0\\\",\\\"sequence_id\\\":null,\\\"etag\\\":null,\\\"name\\\":\\\"All Files\\\"},{\\\"type\\\":\\\"folder\\\",\\\"id\\\":\\\"48019752561\\\",\\\"sequence_id\\\":\\\"0\\\",\\\"etag\\\":\\\"0\\\",\\\"name\\\":\\\"thehook\\\"}]},\\\"created_at\\\":\\\"2018-03-20T08:22:41-07:00\\\",\\\"modified_at\\\":\\\"2018-03-20T08:22:41-07:00\\\",\\\"trashed_at\\\":null,\\\"purged_at\\\":null,\\\"content_created_at\\\":\\\"2018-01-12T12:18:45-08:00\\\",\\\"content_modified_at\\\":\\\"2018-01-12T12:18:45-08:00\\\",\\\"created_by\\\":{\\\"type\\\":\\\"user\\\",\\\"id\\\":\\\"1939107463\\\",\\\"name\\\":\\\"Smith Cornwell\\\",\\\"login\\\":\\\"smithwc6@live.com\\\"},\\\"modified_by\\\":{\\\"type\\\":\\\"user\\\",\\\"id\\\":\\\"1939107463\\\",\"\\\"name\\\":\\\"Smith Cornwell\\\",\\\"login\\\":\\\"smithwc6@live.com\\\"},\\\"owned_by\\\":{\\\"type\\\":\\\"user\\\",\\\"id\\\":\\\"1939087316\\\",\\\"name\\\":\\\"Smith Cornwell\\\",\\\"login\\\":\\\"smitty.cornwell@oracle.com\\\"},\\\"shared_link\\\":null,\\\"parent\\\":{\\\"type\\\":\\\"folder\\\",\\\"id\\\":\\\"48019752561\\\",\\\"sequence_id\\\":\\\"0\\\",\\\"etag\\\":\\\"0\\\",\\\"name\\\":\\\"thehook\\\"},\\\"item_status\\\":\\\"active\\\"},\\\"additional_info\\\":[]}\",\"trigger\":\"FILE.UPLOADED\",\"webhook\":{\"id\":\"36213749\",\"type\":\"webhook\"},\"source\":{\"id\":\"283920683080\",\"type\":\"file\",\"sha1\":\"f60a3949ff8740a3bdba0b34da291b04a0147188\",\"name\":\"notpassdata.txt\",\"size\":\"12734\",\"owned_by\":{\"id\":\"1939087316\",\"type\":\"user\",\"login\":\"smitty.cornwell@oracle.com\",\"name\":\"Smith Cornwell\"},\"parent\":{\"id\":\"48019752561\",\"type\":\"folder\",\"name\":\"thehook\",\"sequence_id\":\"0\",\"etag\":\"0\"},\"item\":null,\"extension\":\"txt\",\"file_version\":{\"id\":\"298721521480\",\"type\":\"file_version\",\"sha1\":\"f60a3949ff8740a3bdba0b34da291b04a0147188\"},\"path_collection\":{\"entries\":[{\"id\":\"0\",\"type\":\"folder\",\"name\":\"All Files\",\"sequence_id\":null,\"etag\":null},{\"id\":\"48019752561\",\"type\":\"folder\",\"name\":\"thehook\",\"sequence_id\":\"0\",\"etag\":\"0\"}],\"total_count\":\"2\"},\"created_at\":\"2018-03-20T08:22:41-07:00\",\"modified_at\":\"2018-03-20T08:22:41-07:00\",\"content_created_at\":\"2018-01-12T12:18:45-08:00\",\"content_modified_at\":\"2018-01-12T12:18:45-08:00\",\"created_by\":{\"id\":\"1939107463\",\"type\":\"user\",\"login\":\"smithwc6@live.com\",\"name\":\"Smith Cornwell\"},\"modified_by\":{\"id\":\"1939107463\",\"type\":\"user\",\"login\":\"smithwc6@live.com\",\"name\":\"Smith Cornwell\"},\"item_status\":\"active\",\"sequence_id\":\"0\",\"purged_at\":null,\"description\":\"\",\"shared_link\":null,\"etag\":\"0\",\"trashed_at\":null},\"created_at\":\"2018-03-20T08:22:41-07:00\",\"created_by\":{\"id\":\"1939107463\",\"type\":\"user\",\"login\":\"smithwc6@live.com\",\"name\":\"Smith Cornwell\"},\"additional_info\":[]},\"triggerType\":\"WEBHOOK\"}]\n" +
                " ";
        if (argv.length != 1) {
            System.err.println("Please specify 1 parameters ");
            System.exit(-1);
        }
        String topicName = argv[0];
      //  in = new Scanner(System.in);
        System.out.println("Enter message(type exit to quit)");

        //Configure the Producer
        Properties configProperties = new Properties();
        configProperties.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG,"localhost:9092");
        configProperties.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG,"org.apache.kafka.common.serialization.ByteArraySerializer");
        configProperties.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG,"org.apache.kafka.common.serialization.StringSerializer");

        org.apache.kafka.clients.producer.Producer producer = new KafkaProducer(configProperties);
        ProducerRecord<String, String> rec = new ProducerRecord<String, String>(topicName,TestData);
        producer.send(rec);
     //   String line = in.nextLine();
    /*    while(!line.equals("exit")) {
            //TODO: Make sure to use the ProducerRecord constructor that does not take parition Id
            ProducerRecord<String, String> rec = new ProducerRecord<String, String>(topicName,line);
            producer.send(rec);
            line = in.nextLine();
        }*/
   //     in.close();
        producer.close();
    }
}